---
Name: restruct-mfa-bundle
After:
  - 'totpauthenticatorconfig'
  - 'MFAWebAuthnAuthenticator'
---
# Require at least one MFA method to be registered
SilverStripe\MFA\Service\EnforcementManager:
  required_mfa_methods: 1

# Register TOTP config extension for customizable issuer, period, etc.
# SS default: https://userhelp.silverstripe.org/en/5/optional_features/multi-factor_authentication/user_manual/using_authenticator_apps/
SilverStripe\TOTP\RegisterHandler:
  user_help_link: '/mfa-help/totp'
  extensions:
    - Restruct\MFABundle\Extensions\TOTPConfigExtension

# WebAuthn: Allow both platform authenticators (Touch ID, Windows Hello)
# and cross-platform authenticators (USB security keys)
# Default is 'cross-platform' only, which excludes biometrics
# Options: null (both), 'platform' (biometrics only), 'cross-platform' (keys only)
# SS default: https://userhelp.silverstripe.org/en/5/optional_features/multi-factor_authentication/user_manual/using_security_keys/
SilverStripe\WebAuthn\RegisterHandler:
  authenticator_attachment: ~
  user_help_link: '/mfa-help/webauthn'

# SS default: https://userhelp.silverstripe.org/en/5/optional_features/multi-factor_authentication/
SilverStripe\MFA\Authenticator\LoginHandler:
  user_help_link: '/mfa-help/'

# SS default: https://userhelp.silverstripe.org/en/5/optional_features/multi-factor_authentication/user_manual/regaining_access/
SilverStripe\MFA\BackupCode\RegisterHandler:
  user_help_link: '/mfa-help/backup-codes'

# Add admin interface for managing user MFA methods
SilverStripe\Security\Member:
  extensions:
    - Restruct\MFABundle\Extensions\MemberMFAAdminExtension

# Add summary fields for RegisteredMethod GridField display
SilverStripe\MFA\Model\RegisteredMethod:
  extensions:
    - Restruct\MFABundle\Extensions\RegisteredMethodExtension